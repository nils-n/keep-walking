{% extends "base.html" %}

{% load tailwind_filters %}


{% load widget_tweaks %}

{% block title %}Keep on Walking{% endblock %}

{% block content %}

{% if user.is_authenticated %}


<div class="sm:py-14 py-10 px-4 "> 
  <div class="px-4 w-full mx-auto" style='max-width:1200px '>
			<h1 class = 'text-blue-700 text-4xl font-bold py-4 '> <span><i class="fa-solid fa-table-columns"></i> </span> Dashboard</h1>
			<!--p class='text-blue-400 font-semibold text-lg'>Hi {{ user.username }}!<-->
			<p class='pt-1 pb-4 text-blue-500 sm:text-lg font-normal' style='line-height:1.6; max-width:79ch'> Hi {{ user.username}}! Here you can find all the information about your latest activities, sync your data with your Garmin watch and read a summary about your progress. </p>
			<!-- small form to allow user syncing data with Garmin watch--> 
			<div class='md:flex flex-wrap justify-between items-center'>
				<div class='sm:inline-block'> 
					<h2 class = 'text-blue-600 text-2xl font-bold pt-4 '><span> <i class="fa-solid fa-rotate"> </i> </span> Sync Your Data </h2>
					<p class='pt-2 pb-4 text-blue-500  sm:text-lg font-normal' style='line-height:1.6'> Use your Garmin login to sync your data from your watch. </p>
					<div class='bg-blue-200 px-4 py-7 rounded-2xl shadow-lg mt-2 mb-8'>
						<div class='pt-1 block'>
							<form hx-post=" {% url 'load_activities' %}" hx-target='#activities-list'  >
								{% csrf_token %}
								{{ garmin_form |crispy }}
								<button class='px-10 py-3 mt-4  text-blue-50 bg-blue-800 hover:bg-blue-300  hover:text-blue-800 rounded shadow' type="submit">Sync</button>
							</form>
						</div>
					</div>
				</div>
			<div class='block sm:inline-block'>
				<div id='activities-list'>
						{% include "partials/activities.html" %}
				</div>
			</div>
			<div class='inline-block'>
				<div class=" pt-8 md:pt-2  px-4 "> 
					<div class="px-4 py-14 md:py-2 w-full mx-auto " style='max-width:79ch '>
							<h2 class = 'text-blue-600 text-2xl font-bold pt-1 pb-3'><span> <i class="fa-solid  fa-circle-check"> </i> </span> Your Summary </h2>
							<p id='summary-intro'>Here goes a summary based on the previous month. Will be done in javascript.</p>
							<ul class='list-disc px-4 py-4 leading-loose'>
								<li> <span class='text-blue-600 '>BMI </span> : <span id='bmi-message'> <span id='average-bmi'>{{ average_bmi }} </span>  <span id='change-bmi'> {{ change_bmi }} </span>  </span> </li>
								<li> <span class='text-blue-600 '>Average Weight</span>: You average weight this month was <span class='text-bold text-blue-500'> 75.1 kg<span> </li>
								<li><span class='text-blue-600 '>Happniess</span> : Your average rating was <span class='text-bold text-blue-500' id='average-rating'> 1.4 </span>. Last month the rating was  <span class='text-bold text-blue-500' id='change-rating'> 1.1 <span>  </li>
							</ul>
					</div>
				</div>
			</div>
			<div class='inline-block pt-8' style='max-width:79ch; min-width:200px'>
				<div class=" pt-8 md:pt-2  px-4 "> 
					<div class="px-4 py-14 md:py-2 w-full mx-auto ">
						<h2 class = 'text-blue-600 text-2xl font-bold pt-1 pb-4'><span> <i class="fa-solid fa-calendar-days"></i> </span> Previous 30 Days </h2>
						<div class='' style='min-width:350px; min-height:350px;'>
							{{ div|safe  }}
						</div>	
					</div>
				</div>
			</div>
		</div>
	</div>
</div>



{% else %}
  <p>You are not logged in</p>
  <a href="{% url 'login' %}">Log In</a> |
  <a href="{% url 'signup' %}">Sign Up</a>
{% endif %}

{% endblock %}


{% block javascript %}

{% load static %}

<script src= {% static  'scripts/activities.js'  %}></script>

{{ script |safe  }}

{%  endblock %}



